"""
Internationalization (i18n) system for Smart Budget Manager.
Supports English, French, and Arabic with RTL layout for Arabic.
"""

from typing import Dict, Any, Optional
from enum import Enum


class Language(str, Enum):
    """Supported languages."""
    ENGLISH = "en"
    FRENCH = "fr"
    ARABIC = "ar"


class TranslationManager:
    """Manages translations and language settings."""
    
    def __init__(self):
        """Initialize translation manager."""
        self.current_language = Language.ENGLISH
        self.translations: Dict[str, Dict[str, Any]] = {}
        self.load_translations()
    
    def load_translations(self) -> None:
        """Load all translation files."""
        # English translations (base)
        self.translations[Language.ENGLISH] = {
            "app_title": "Smart Budget Manager",
            "welcome_message": "Welcome, {}!",
            "navigation": "Navigation",
            "logout": "Logout",
            "dashboard": "Dashboard",
            "income_goals": "Income & Goals",
            "expenses": "Expenses", 
            "reports": "Reports",
            "settings": "Settings",
            "login": "Login",
            "register": "Register",
            "username": "Username",
            "password": "Password",
            "email": "Email",
            "full_name": "Full Name",
            "login_to_account": "Login to Your Account",
            "create_account": "Create New Account",
            "login_button": "üöÄ Login",
            "register_button": "‚ú® Create Account",
            "choose_option": "Choose an option:",
            "enter_username": "Enter your username",
            "enter_password": "Enter your password",
            "your_email": "your.email@example.com",
            "full_name_optional": "Your full name (optional)",
            "choose_username": "Choose a username",
            "choose_password": "Choose a strong password",
            "confirm_password": "Confirm Password",
            "confirm_your_password": "Confirm your password",
            "welcome_back": "Welcome back, {}! üéâ",
            "account_created": "Account created successfully for {}! üéâ",
            "please_login": "Please login with your new credentials.",
            "login_failed": "Login failed: {}",
            "registration_failed": "Registration failed: {}",
            "fill_all_fields": "Please fill in all fields",
            "fill_required_fields": "Please fill in all required fields",
            "passwords_not_match": "Passwords do not match",
            "password_min_length": "Password must be at least 6 characters",
            "invalid_email": "Please enter a valid email address",
            "username_help": "Must be 3-50 characters, letters, numbers, hyphens and underscores only",
            "password_help": "Must be at least 6 characters",
            "error_occurred": "An error occurred: {}",
            "user_account": "User Account",
            "account_stats": "Account Stats:",
            "income_entries": "Income entries: {}",
            "total_expenses": "Expenses: {}",
            "total_goals": "Savings goals: {}",
            "member_since": "Member since: {} days",
            "language_settings": "Language Settings",
            "select_language": "Select Language",
            "language_english": "English",
            "language_french": "Fran√ßais", 
            "language_arabic": "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",
            "language_changed": "Language changed to {}",
            "budget_dashboard": "Budget Dashboard",
            "monthly_income": "Monthly Income",
            "current_savings": "Current Savings",
            "savings_target": "Savings Target",
            "smart_recommendation": "Today's Smart Recommendation",
            "daily_spending_limit": "Daily Spending Limit:",
            "days_remaining": "Days Remaining:",
            "spent_this_month": "Spent This Month:",
            "projected_savings": "Projected Savings:",
            "savings_progress": "Savings Progress",
            "smart_alerts": "Smart Alerts",
            "recent_expenses": "Recent Expenses",
            "no_budget_data": "No budget data available. Please set up your income and savings goals first!",
            "set_income": "Set Income",
            "add_expense": "Add Expense",
            "error_loading_dashboard": "Error loading dashboard: {}",
            "set_monthly_income": "Set Monthly Income",
            "monthly_income_label": "Monthly Income",
            "description_optional": "Description (optional)",
            "eg_main_salary": "e.g., Main salary",
            "month": "Month",
            "set_income_button": "üí∞ Set Income",
            "current_month_income": "Current Month Income",
            "recent_entries": "Recent Entries:",
            "income_set": "Income set: {} for {}",
            "error_setting_income": "Error setting income: {}",
            "set_savings_goals": "Set Savings Goals",
            "monthly_savings_target": "Monthly Savings Target", 
            "goal_description_optional": "Goal Description (optional)",
            "eg_emergency_fund": "e.g., Emergency fund",
            "target_month": "Target Month",
            "set_goal_button": "üéØ Set Goal",
            "current_month_goal": "Current Month Goal",
            "description": "Description:",
            "savings_goal_set": "Savings goal set: {} for {}",
            "no_savings_goal": "No savings goal set for current month",
            "error_setting_goal": "Error setting goal: {}",
            "expense_management": "Expense Management",
            "add_expense_tab": "Add Expense",
            "view_expenses_tab": "View Expenses",
            "add_new_expense": "Add New Expense",
            "amount": "Amount",
            "category": "Category",
            "date": "Date",
            "add_expense_button": "üí∏ Add Expense",
            "expense_added": "Expense added: {} - {}",
            "updated_daily_limit": "Updated daily limit: {}",
            "today_spending": "Today's Spending",
            "today_expenses": "Today's Expenses:",
            "error_adding_expense": "Error adding expense: {}",
            "expense_history": "Expense History",
            "time_period": "Time Period",
            "category_filter": "Category Filter",
            "all_categories": "All",
            "number_of_records": "Number of Records",
            "total_amount": "Total Amount",
            "number_of_expenses": "Number of Expenses",
            "average_amount": "Average Amount",
            "spending_by_category": "Spending by Category (Last {} days)",
            "no_expenses_found": "No expenses found for the selected criteria.",
            "reports_analytics": "Reports & Analytics",
            "monthly_report": "Monthly Report",
            "trends": "Trends", 
            "goals_analysis": "Goals Analysis",
            "monthly_budget_report": "Monthly Budget Report",
            "select_month": "Select Month",
            "income": "Income",
            "expenses": "Expenses",
            "savings": "Savings",
            "savings_rate": "Savings Rate",
            "financial_summary": "Financial Summary",
            "goal_achievement": "Savings Goal Achievement",
            "expense_categories": "Expense Categories",
            "percentage": "Percentage",
            "category_distribution": "Category Distribution",
            "no_data_available": "No data available for {}",
            "error_generating_report": "Error generating report: {}",
            "spending_trends": "Spending Trends",
            "monthly_spending_trend": "Monthly Spending Trend",
            "monthly_transaction_count": "Monthly Transaction Count",
            "not_enough_data": "Not enough data to show trends. Start adding expenses to see trends over time!",
            "target_amount": "Target Amount",
            "progress": "Progress",
            "days_passed": "Days Passed",
            "on_track_goal": "You're on track to meet your savings goal!",
            "adjust_spending": "You may need to adjust your spending to meet your goal.",
            "required_daily_savings": "To reach your goal, you need to save {} per day for the remaining {} days.",
            "setup_goals": "Set up your income and savings goals to see goal analysis.",
            "application_settings": "Application Settings",
            "data_management": "Data Management",
            "preferences": "Preferences",
            "export_data": "Export Data",
            "export_expenses_csv": "üì§ Export Expenses to CSV",
            "download_csv": "üíæ Download CSV",
            "no_expenses_export": "No expenses to export",
            "error_exporting": "Error exporting data: {}",
            "database_info": "Database Info",
            "database_statistics": "Database Statistics:",
            "total_expenses_stat": "Total Expenses: {}",
            "income_entries_stat": "Income Entries: {}",
            "savings_goals_stat": "Savings Goals: {}",
            "error_loading_db_info": "Error loading database info: {}",
            "reset_database": "Reset Database",
            "danger_zone": "Danger Zone",
            "reset_warning": "This will permanently delete ALL your data:",
            "reset_warning_income": "Income entries",
            "reset_warning_expenses": "Expense records",
            "reset_warning_goals": "Savings goals", 
            "reset_warning_history": "All historical data",
            "understand_delete": "I understand this will delete all my data",
            "absolutely_sure": "I am absolutely sure I want to proceed",
            "reset_database_button": "üóëÔ∏è RESET DATABASE",
            "database_reset_success": "Database has been reset successfully! The page will refresh.",
            "database_reset_error": "Error resetting database: {}",
            "currency_settings": "Currency Settings",
            "select_currency": "Select Currency",
            "currency_preview": "Preview:",
            "formatting_options": "Formatting Options",
            "decimal_places": "Decimal Places",
            "thousands_separator": "Thousands Separator",
            "currency_updated": "Currency settings updated successfully!",
            "food": "Food",
            "transportation": "Transportation", 
            "entertainment": "Entertainment",
            "utilities": "Utilities",
            "shopping": "Shopping",
            "health": "Health",
            "education": "Education",
            "other": "Other",
            "save": "Save",
            "cancel": "Cancel",
            "close": "Close",
            "delete": "Delete",
            "edit": "Edit",
            "add": "Add",
            "update": "Update",
            "confirm": "Confirm",
            "success": "Success",
            "error": "Error",
            "warning": "Warning",
            "info": "Info",
            "loading": "Loading...",
            "no_data": "No data available",
            "required": "Required",
            "optional": "Optional"
        }
        
        # French translations
        self.translations[Language.FRENCH] = {
            "app_title": "Gestionnaire de Budget Intelligent",
            "welcome_message": "Bienvenue, {} !",
            "navigation": "Navigation",
            "logout": "D√©connexion",
            "dashboard": "Tableau de bord",
            "income_goals": "Revenus et Objectifs",
            "expenses": "D√©penses",
            "reports": "Rapports",
            "settings": "Param√®tres",
            "login": "Connexion",
            "register": "S'inscrire",
            "username": "Nom d'utilisateur",
            "password": "Mot de passe",
            "email": "E-mail",
            "full_name": "Nom complet",
            "login_to_account": "Connectez-vous √† votre compte",
            "create_account": "Cr√©er un nouveau compte",
            "login_button": "üöÄ Se connecter",
            "register_button": "‚ú® Cr√©er un compte",
            "choose_option": "Choisissez une option :",
            "enter_username": "Entrez votre nom d'utilisateur",
            "enter_password": "Entrez votre mot de passe",
            "your_email": "votre.email@exemple.com",
            "full_name_optional": "Votre nom complet (optionnel)",
            "choose_username": "Choisissez un nom d'utilisateur",
            "choose_password": "Choisissez un mot de passe fort",
            "confirm_password": "Confirmer le mot de passe",
            "confirm_your_password": "Confirmez votre mot de passe",
            "welcome_back": "Bon retour, {} ! üéâ",
            "account_created": "Compte cr√©√© avec succ√®s pour {} ! üéâ",
            "please_login": "Veuillez vous connecter avec vos nouveaux identifiants.",
            "login_failed": "√âchec de la connexion : {}",
            "registration_failed": "√âchec de l'inscription : {}",
            "fill_all_fields": "Veuillez remplir tous les champs",
            "fill_required_fields": "Veuillez remplir tous les champs obligatoires",
            "passwords_not_match": "Les mots de passe ne correspondent pas",
            "password_min_length": "Le mot de passe doit contenir au moins 6 caract√®res",
            "invalid_email": "Veuillez entrer une adresse e-mail valide",
            "username_help": "Doit contenir 3-50 caract√®res, lettres, chiffres, tirets et underscores uniquement",
            "password_help": "Doit contenir au moins 6 caract√®res",
            "error_occurred": "Une erreur s'est produite : {}",
            "user_account": "Compte utilisateur",
            "account_stats": "Statistiques du compte :",
            "income_entries": "Entr√©es de revenus : {}",
            "total_expenses": "D√©penses : {}",
            "total_goals": "Objectifs d'√©pargne : {}",
            "member_since": "Membre depuis : {} jours",
            "language_settings": "Param√®tres de langue",
            "select_language": "S√©lectionner la langue",
            "language_english": "English",
            "language_french": "Fran√ßais",
            "language_arabic": "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",
            "language_changed": "Langue chang√©e en {}",
            "budget_dashboard": "Tableau de bord du budget",
            "monthly_income": "Revenus mensuels",
            "current_savings": "√âpargne actuelle",
            "savings_target": "Objectif d'√©pargne",
            "smart_recommendation": "Recommandation intelligente d'aujourd'hui",
            "daily_spending_limit": "Limite de d√©pense quotidienne :",
            "days_remaining": "Jours restants :",
            "spent_this_month": "D√©pens√© ce mois :",
            "projected_savings": "√âpargne projet√©e :",
            "savings_progress": "Progr√®s de l'√©pargne",
            "smart_alerts": "Alertes intelligentes",
            "recent_expenses": "D√©penses r√©centes",
            "no_budget_data": "Aucune donn√©e budg√©taire disponible. Veuillez d'abord configurer vos revenus et objectifs d'√©pargne !",
            "set_income": "D√©finir les revenus",
            "add_expense": "Ajouter une d√©pense",
            "error_loading_dashboard": "Erreur lors du chargement du tableau de bord : {}",
            "set_monthly_income": "D√©finir les revenus mensuels",
            "monthly_income_label": "Revenus mensuels",
            "description_optional": "Description (optionnelle)",
            "eg_main_salary": "ex. Salaire principal",
            "month": "Mois",
            "set_income_button": "üí∞ D√©finir les revenus",
            "current_month_income": "Revenus du mois actuel",
            "recent_entries": "Entr√©es r√©centes :",
            "income_set": "Revenus d√©finis : {} pour {}",
            "error_setting_income": "Erreur lors de la d√©finition des revenus : {}",
            "set_savings_goals": "D√©finir les objectifs d'√©pargne",
            "monthly_savings_target": "Objectif d'√©pargne mensuel",
            "goal_description_optional": "Description de l'objectif (optionnelle)",
            "eg_emergency_fund": "ex. Fonds d'urgence",
            "target_month": "Mois cible",
            "set_goal_button": "üéØ D√©finir l'objectif",
            "current_month_goal": "Objectif du mois actuel",
            "description": "Description :",
            "savings_goal_set": "Objectif d'√©pargne d√©fini : {} pour {}",
            "no_savings_goal": "Aucun objectif d'√©pargne d√©fini pour le mois actuel",
            "error_setting_goal": "Erreur lors de la d√©finition de l'objectif : {}",
            "expense_management": "Gestion des d√©penses",
            "add_expense_tab": "Ajouter une d√©pense",
            "view_expenses_tab": "Voir les d√©penses",
            "add_new_expense": "Ajouter une nouvelle d√©pense",
            "amount": "Montant",
            "category": "Cat√©gorie",
            "date": "Date",
            "add_expense_button": "üí∏ Ajouter une d√©pense",
            "expense_added": "D√©pense ajout√©e : {} - {}",
            "updated_daily_limit": "Limite quotidienne mise √† jour : {}",
            "today_spending": "D√©penses d'aujourd'hui",
            "today_expenses": "D√©penses d'aujourd'hui :",
            "error_adding_expense": "Erreur lors de l'ajout de la d√©pense : {}",
            "expense_history": "Historique des d√©penses",
            "time_period": "P√©riode",
            "category_filter": "Filtre par cat√©gorie",
            "all_categories": "Toutes",
            "number_of_records": "Nombre d'enregistrements",
            "total_amount": "Montant total",
            "number_of_expenses": "Nombre de d√©penses",
            "average_amount": "Montant moyen",
            "spending_by_category": "D√©penses par cat√©gorie (Derniers {} jours)",
            "no_expenses_found": "Aucune d√©pense trouv√©e pour les crit√®res s√©lectionn√©s.",
            "reports_analytics": "Rapports et analyses",
            "monthly_report": "Rapport mensuel",
            "trends": "Tendances",
            "goals_analysis": "Analyse des objectifs",
            "monthly_budget_report": "Rapport budg√©taire mensuel",
            "select_month": "S√©lectionner le mois",
            "income": "Revenus",
            "expenses": "D√©penses",
            "savings": "√âpargne",
            "savings_rate": "Taux d'√©pargne",
            "financial_summary": "R√©sum√© financier",
            "goal_achievement": "R√©alisation de l'objectif d'√©pargne",
            "expense_categories": "Cat√©gories de d√©penses",
            "percentage": "Pourcentage",
            "category_distribution": "R√©partition par cat√©gorie",
            "no_data_available": "Aucune donn√©e disponible pour {}",
            "error_generating_report": "Erreur lors de la g√©n√©ration du rapport : {}",
            "spending_trends": "Tendances des d√©penses",
            "monthly_spending_trend": "Tendance des d√©penses mensuelles",
            "monthly_transaction_count": "Nombre de transactions mensuelles",
            "not_enough_data": "Pas assez de donn√©es pour afficher les tendances. Commencez √† ajouter des d√©penses pour voir les tendances au fil du temps !",
            "target_amount": "Montant cible",
            "progress": "Progr√®s",
            "days_passed": "Jours √©coul√©s",
            "on_track_goal": "Vous √™tes en bonne voie pour atteindre votre objectif d'√©pargne !",
            "adjust_spending": "Vous devrez peut-√™tre ajuster vos d√©penses pour atteindre votre objectif.",
            "required_daily_savings": "Pour atteindre votre objectif, vous devez √©conomiser {} par jour pendant les {} jours restants.",
            "setup_goals": "Configurez vos revenus et objectifs d'√©pargne pour voir l'analyse des objectifs.",
            "application_settings": "Param√®tres de l'application",
            "data_management": "Gestion des donn√©es",
            "preferences": "Pr√©f√©rences",
            "export_data": "Exporter les donn√©es",
            "export_expenses_csv": "üì§ Exporter les d√©penses en CSV",
            "download_csv": "üíæ T√©l√©charger CSV",
            "no_expenses_export": "Aucune d√©pense √† exporter",
            "error_exporting": "Erreur lors de l'exportation des donn√©es : {}",
            "database_info": "Informations de la base de donn√©es",
            "database_statistics": "Statistiques de la base de donn√©es :",
            "total_expenses_stat": "Total des d√©penses : {}",
            "income_entries_stat": "Entr√©es de revenus : {}",
            "savings_goals_stat": "Objectifs d'√©pargne : {}",
            "error_loading_db_info": "Erreur lors du chargement des informations de la base de donn√©es : {}",
            "reset_database": "R√©initialiser la base de donn√©es",
            "danger_zone": "Zone de danger",
            "reset_warning": "Ceci supprimera d√©finitivement TOUTES vos donn√©es :",
            "reset_warning_income": "Entr√©es de revenus",
            "reset_warning_expenses": "Enregistrements de d√©penses",
            "reset_warning_goals": "Objectifs d'√©pargne",
            "reset_warning_history": "Toutes les donn√©es historiques",
            "understand_delete": "Je comprends que cela supprimera toutes mes donn√©es",
            "absolutely_sure": "Je suis absolument s√ªr de vouloir proc√©der",
            "reset_database_button": "üóëÔ∏è R√âINITIALISER LA BASE DE DONN√âES",
            "database_reset_success": "La base de donn√©es a √©t√© r√©initialis√©e avec succ√®s ! La page va se rafra√Æchir.",
            "database_reset_error": "Erreur lors de la r√©initialisation de la base de donn√©es : {}",
            "currency_settings": "Param√®tres de devise",
            "select_currency": "S√©lectionner la devise",
            "currency_preview": "Aper√ßu :",
            "formatting_options": "Options de formatage",
            "decimal_places": "D√©cimales",
            "thousands_separator": "S√©parateur de milliers",
            "currency_updated": "Param√®tres de devise mis √† jour avec succ√®s !",
            "food": "Nourriture",
            "transportation": "Transport",
            "entertainment": "Divertissement",
            "utilities": "Services publics",
            "shopping": "Shopping",
            "health": "Sant√©",
            "education": "√âducation",
            "other": "Autre",
            "save": "Enregistrer",
            "cancel": "Annuler",
            "close": "Fermer",
            "delete": "Supprimer",
            "edit": "Modifier",
            "add": "Ajouter",
            "update": "Mettre √† jour",
            "confirm": "Confirmer",
            "success": "Succ√®s",
            "error": "Erreur",
            "warning": "Avertissement",
            "info": "Information",
            "loading": "Chargement...",
            "no_data": "Aucune donn√©e disponible",
            "required": "Obligatoire",
            "optional": "Optionnel"
        }
        
        # Arabic translations
        self.translations[Language.ARABIC] = {
            "app_title": "ŸÖÿØŸäÿ± ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ© ÿßŸÑÿ∞ŸÉŸä",
            "welcome_message": "ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå {}!",
            "navigation": "ÿßŸÑÿ™ŸÜŸÇŸÑ",
            "logout": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨",
            "dashboard": "ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
            "income_goals": "ÿßŸÑÿØÿÆŸÑ ŸàÿßŸÑÿ£ŸáÿØÿßŸÅ",
            "expenses": "ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™",
            "reports": "ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±",
            "settings": "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
            "login": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
            "register": "ÿ™ÿ≥ÿ¨ŸäŸÑ",
            "username": "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ",
            "password": "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
            "email": "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä",
            "full_name": "ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ",
            "login_to_account": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ•ŸÑŸâ ÿ≠ÿ≥ÿßÿ®ŸÉ",
            "create_account": "ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ® ÿ¨ÿØŸäÿØ",
            "login_button": "üöÄ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
            "register_button": "‚ú® ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®",
            "choose_option": "ÿßÿÆÿ™ÿ± ÿÆŸäÿßÿ±ÿßŸã:",
            "enter_username": "ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ",
            "enter_password": "ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
            "your_email": "ÿ®ÿ±ŸäÿØŸÉ.ÿßŸÑÿßŸÑŸÉÿ™ÿ±ŸàŸÜŸä@ŸÖÿ´ÿßŸÑ.com",
            "full_name_optional": "ÿßÿ≥ŸÖŸÉ ÿßŸÑŸÉÿßŸÖŸÑ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)",
            "choose_username": "ÿßÿÆÿ™ÿ± ÿßÿ≥ŸÖ ŸÖÿ≥ÿ™ÿÆÿØŸÖ",
            "choose_password": "ÿßÿÆÿ™ÿ± ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ŸÇŸàŸäÿ©",
            "confirm_password": "ÿ™ÿ£ŸÉŸäÿØ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
            "confirm_your_password": "ÿ£ŸÉÿØ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
            "welcome_back": "ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ÿπŸàÿØÿ™ŸÉÿå {}! üéâ",
            "account_created": "ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ≠ÿ≥ÿßÿ® ÿ®ŸÜÿ¨ÿßÿ≠ ŸÑŸÄ {}! üéâ",
            "please_login": "Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ®ŸäÿßŸÜÿßÿ™ŸÉ ÿßŸÑÿ¨ÿØŸäÿØÿ©.",
            "login_failed": "ŸÅÿ¥ŸÑ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ: {}",
            "registration_failed": "ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ: {}",
            "fill_all_fields": "Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ",
            "fill_required_fields": "Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©",
            "passwords_not_match": "ŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ©",
            "password_min_length": "Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ŸÉŸàŸÜ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± 6 ÿ£ÿ≠ÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ",
            "invalid_email": "Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿπŸÜŸàÿßŸÜ ÿ®ÿ±ŸäÿØ ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ÿµÿ≠Ÿäÿ≠",
            "username_help": "Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ 3-50 ÿ≠ÿ±ŸÅÿßŸãÿå ÿ£ÿ≠ÿ±ŸÅ Ÿàÿ£ÿ±ŸÇÿßŸÖ Ÿàÿ¥ÿ±ÿ∑ÿßÿ™ Ÿàÿ¥ÿ±ÿ∑ÿßÿ™ ÿ≥ŸÅŸÑŸäÿ© ŸÅŸÇÿ∑",
            "password_help": "Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ŸÉŸàŸÜ 6 ÿ£ÿ≠ÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ",
            "error_occurred": "ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£: {}",
            "user_account": "ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ",
            "language_settings": "ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÑÿ∫ÿ©",
            "select_language": "ÿßÿÆÿ™ÿ± ÿßŸÑŸÑÿ∫ÿ©",
            "language_english": "English",
            "language_french": "Fran√ßais",
            "language_arabic": "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",
            "language_changed": "ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÑÿ∫ÿ© ÿ•ŸÑŸâ {}",
            "budget_dashboard": "ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÉŸÖ ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ©",
            "monthly_income": "ÿßŸÑÿØÿÆŸÑ ÿßŸÑÿ¥Ÿáÿ±Ÿä",
            "total_expenses": "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™",
            "current_savings": "ÿßŸÑŸÖÿØÿÆÿ±ÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©",
            "savings_target": "ŸáÿØŸÅ ÿßŸÑÿßÿØÿÆÿßÿ±",
            "set_monthly_income": "ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑÿØÿÆŸÑ ÿßŸÑÿ¥Ÿáÿ±Ÿä",
            "add_new_expense": "ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿµÿ±ŸàŸÅ ÿ¨ÿØŸäÿØ",
            "amount": "ÿßŸÑŸÖÿ®ŸÑÿ∫",
            "description": "ÿßŸÑŸàÿµŸÅ",
            "category": "ÿßŸÑŸÅÿ¶ÿ©",
            "save": "ÿ≠ŸÅÿ∏",
            "cancel": "ÿ•ŸÑÿ∫ÿßÿ°",
            "error": "ÿÆÿ∑ÿ£",
            "success": "ŸÜÿ¨ÿ≠"
        }
    
    def set_language(self, language: Language) -> None:
        """Set current language."""
        self.current_language = language
    
    def get_language(self) -> Language:
        """Get current language."""
        return self.current_language
    
    def is_rtl(self) -> bool:
        """Check if current language is right-to-left."""
        return self.current_language == Language.ARABIC
    
    def translate(self, key: str, *args) -> str:
        """
        Get translated text for the given key.
        
        Args:
            key: Translation key
            *args: Format arguments
            
        Returns:
            Translated text
        """
        translations = self.translations.get(self.current_language, {})
        text = translations.get(key, key)  # Fallback to key if not found
        
        # Format with arguments if provided
        if args:
            try:
                return text.format(*args)
            except (ValueError, IndexError):
                return text
        
        return text
    
    def get_language_options(self) -> Dict[str, str]:
        """Get available language options."""
        return {
            Language.ENGLISH: self.translate("language_english"),
            Language.FRENCH: self.translate("language_french"), 
            Language.ARABIC: self.translate("language_arabic")
        }


# Global translation manager instance
_translation_manager = TranslationManager()


def get_translation_manager() -> TranslationManager:
    """Get the global translation manager instance."""
    return _translation_manager


def t(key: str, *args) -> str:
    """
    Shorthand function for translation.
    
    Args:
        key: Translation key
        *args: Format arguments
        
    Returns:
        Translated text
    """
    return _translation_manager.translate(key, *args)


def set_language(language: Language) -> None:
    """Set the application language."""
    _translation_manager.set_language(language)


def get_current_language() -> Language:
    """Get the current application language."""
    return _translation_manager.get_language()


def is_rtl() -> bool:
    """Check if current language requires right-to-left layout."""
    return _translation_manager.is_rtl() 